Prepare the following queries for Partnership Management Database System :

1. Find all the active partnerships involving a specific company user.

SELECT p.*
FROM Partnerships p
JOIN PartnershipUsers pu ON p.id = pu.partnership_id
JOIN Users u ON pu.user_id = u.id
WHERE u.id = user_id AND (p.end_date IS NULL OR p.end_date > CURRENT_DATE);

2. List all company users with their roles.

SELECT u.name, u.email, u.role
FROM Users u
WHERE u.company_id = company_id;

3. List all users associated with a specific partnership, including their roles.

SELECT u.name, u.email, pu.role
FROM PartnershipUsers pu
JOIN Users u ON pu.user_id = u.id
WHERE pu.partnership_id = partnership_id;

4. Get the total revenue generated by the specific partnership for a company.

SELECT SUM(o.amount) AS total_revenue
FROM Opportunities o
JOIN Accounts a ON o.account_id = a.id
JOIN Leads l ON a.lead_id = l.id
JOIN Campaigns c ON l.campaign_id = c.id
WHERE c.partnership_id = partnership_id AND a.company_id = company_id;
